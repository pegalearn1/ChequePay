{% extends 'layouts/base.html' %}
{% load i18n %}
{% load static %}
{% block tiitle %}{% trans "Reports" %}{% endblock tiitle %}
{% block stylesheet %}

<style>
    /* Add spacing around the table */
    .table-responsive {
        padding: 15px;
    }
  
    /* Improve table spacing */
    table.dataTable {
        margin-top: 10px !important;
        border-spacing: 0 10px; /* Adds space between rows */
    }
  
    /* Center pagination */
    .dataTables_wrapper .dataTables_paginate {
        text-align: center !important;
        margin-top: 10px;
    }
  
    /* Table header styling */
    .dataTable thead th {
        background-color: #f8f9fa;
        padding: 12px;
        border-bottom: 2px solid #dee2e6;
    }
  </style>
  

{% endblock stylesheet %}
{% block content %}

<!-- Page header -->
<div class="page-header d-print-none">
    <div class="container-xl">
      <div class="row g-2 align-items-center">
        <div class="col">
          <h2 class="page-title">
            {% trans "Reports" %}
          </h2>
        </div>
    </div>
</div>

<!-- Page body -->
<div class="page-body">
    <div class="container-xl">
        <div class="row">
            <!-- Filters and Search Section -->
            <div class="col-md-3">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">{% trans "Filters" %}</h4>
                    </div>
                    <div class="card-body">
                        <form method="post" id="report">
                            
                            <!-- Approval Filter -->
                            <div class="mb-3">
                                <label for="approvalFilter">{% trans "Approval Status" %}</label>
                                <select class="form-control" name="approval" id="approvalFilter">
                                    <option value="">{% trans "Select Approval Status" %}</option>
                                    <option value="All" {% if approval == 'All' %}selected{% endif %}>All</option>
                                    <option value="approved" {% if approval == 'approved' %}selected{% endif %}>{% trans "Approved" %}</option>
                                    <option value="pending" {% if approval == 'pending' %}selected{% endif %}>{% trans "Pending" %}</option>
                                    <option value="rejected" {% if approval == 'rejected' %}selected{% endif %}>{% trans "Rejected" %}</option>
                                </select>
                            </div>
                            
                            <!-- Date Range Filter -->
                            <div class="mb-3">
                                <label class="mb-2" for="start_date">{% trans "Cheque Date Range" %}</label>
                                <div class="mb-2">
                                    <label for="start_date">{% trans "From" %}</label>
                                    <input type="date" class="form-control" name="start_date" value="{{ start_date }}">
                                </div>
                                <div>
                                    <label for="end_date">{% trans "To" %}</label>
                                    <input type="date" class="form-control" name="end_date" value="{{ end_date }}">
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">{% trans "Apply Filters" %}</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Tabs Section -->
            <div class="col-md-9">
                <div class="card">
                    <div class="card-header">
                        <ul class="nav nav-tabs" id="reportTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-bs-toggle="tab" href="#bank-table">{% trans "Banks" %}</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#payee-table">{% trans "Payees " %}</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#account-table">{% trans "Accounts" %}</a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="tab-content mt-3">
                        
                        <!-- bank-table -->
                        <div class="tab-pane fade show active" id="bank-table">
                           
                            <!-- table -->
                            <div class="table-responsive" >
                                <table class="table card-table table-vcenter text-nowrap datatable" id="bankDataTable">
                                  <thead>
                                    <tr>
                                    <th><input type="checkbox" id="selectAllBank"></th>
                                    <th>{% trans "Bank Char" %}</th>
                                    <th>{% trans "Bank Name E" %}</th>
                                    <th>{% trans "Bank Name L" %}</th>
                                    <th>{% trans "Telephone" %}</th>
                                    <th>{% trans "Address" %}</th>
                                      
                                    </tr>
                                  </thead>
                                  <tbody>
                                      {% if banks %}
                                          {% for bank in banks %}
                                    <tr>
                  
                                    <td class="text-start">

                                        <input type="checkbox" class="rowCheckboxBank">
                  
                                    </td>
                                    
                                    <td>
                                        {{bank.bank_char}}
                                      </td>
                                      <td>
                                        {{bank.bank_name_e}}
                                      </td>
                                      <td>
                                        {{bank.bank_name_l}}
                                      </td>
                                      <td>
                                        {{bank.tel_no}}
                                      </td>
                                      <td>
                                        {{bank.address}}
                                      </td>
                                      
                                    </tr>
                                    {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center">{% trans "No Payees found" %}</td>
                            </tr>
                            {% endif %}
                                  </tbody>
                                </table>
                              </div>
                            <!-- table -->
                        
                        
                        
                        </div>
                        <!-- bank-table -->


                        <!-- payee-table -->
                        <div class="tab-pane fade" id="payee-table">
                            <!-- table -->
                            <div class="table-responsive" >
                                <table class="table card-table table-vcenter text-nowrap datatable" id="payeeDataTable">
                                  <thead>
                                    <tr>
                                      <th><input type="checkbox" id="selectAllPayee">
                                    </th>
                                      <th>{% trans "Payee Name" %}</th>
                                      <th>{% trans "Mobile Number" %}</th>
                                      <th>{% trans "Email" %}</th>
                                      <th>{% trans "Address" %}</th>
                                      
                                    </tr>
                                  </thead>
                                  <tbody>
                                      {% if payees %}
                                          {% for payee in payees %}
                                    <tr>
                  
                                    <td class="text-start">

                                        <input type="checkbox" class="rowCheckboxPayee">
                  
                                    </td>
                                    
                                      <td>{{ payee.payee_name }}</td>
                                      <td>{{ payee.mobile_no }}</td>
                                      <td>{{ payee.email }}</td>
                                      <td>
                                        {% if payee.address %}
                                        {{payee.address}}
                                        {% endif %}
                                      </td>
                                      
                                    </tr>
                                    {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center">{% trans "No Payees found" %}</td>
                            </tr>
                            {% endif %}
                                  </tbody>
                                </table>
                              </div>
                            <!-- table -->
                        
                        </div>
                        <!-- payee-table -->

                        <!-- account-table -->
                        <div class="tab-pane fade show" id="account-table">
                            
                            <!-- table -->
                            <div class="table-responsive" >
                                <table class="table card-table table-vcenter text-nowrap datatable" id="accountDataTable">
                                  <thead>
                                    <tr>
                                      <th><input type="checkbox" id="selectAllAccount"></th>
                                      <th>{% trans "Account Number" %}</th>
                                      <th>{% trans "Bank" %}</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                      {% if accounts %}
                                          {% for account, bank in accounts %}
                                    <tr>
                  
                                    <td class="text-start">

                                        <input type="checkbox" class="rowCheckboxAccount">
                  
                                    </td>
                                    
                                      <td>{{ account }}</td>
                                      <td>{{ bank }}</td>
                                      
                                      
                                    </tr>
                                    {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center">{% trans "No Payees found" %}</td>
                            </tr>
                            {% endif %}
                                  </tbody>
                                </table>
                              </div>
                            <!-- table -->


                        </div>
                        <!-- account-table -->

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script>
$(document).ready(function () {
    $(".nav-link").on("click", function () {
        $(".nav-link").removeClass("active");
        $(this).addClass("active");
    });
});


// Initialize DataTable on page load
document.addEventListener('DOMContentLoaded', function () {
  $('#bankDataTable').DataTable({
    paging: true, // Enable pagination
    pageLength: 10, // Number of rows per page
    lengthChange: true, // Allow changing number of rows per page
    searching: false, // Disable search (optional, if not needed)
    ordering: true, // Enable column sorting
    order: [], // Disable initial ordering
    info: true, // Show info about current page and total rows
    language: {
      paginate: {
        previous: "{% trans 'Previous' %}",
        next: "{% trans 'Next' %}",
      },
      info: "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries' %}",
      lengthMenu: "{% trans 'Show _MENU_ entries' %}",
    },
  });
});


//Initialize DataTable on page load
document.addEventListener('DOMContentLoaded', function () {
  $('#payeeDataTable').DataTable({
    paging: true, // Enable pagination
    pageLength: 10, // Number of rows per page
    lengthChange: true, // Allow changing number of rows per page
    searching: false, // Disable search (optional, if not needed)
    ordering: true, // Enable column sorting
    order: [], // Disable initial ordering
    info: true, // Show info about current page and total rows
    language: {
      paginate: {
        previous: "{% trans 'Previous' %}",
        next: "{% trans 'Next' %}",
      },
      info: "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries' %}",
      lengthMenu: "{% trans 'Show _MENU_ entries' %}",
    },
  });
});

//Initialize DataTable on page load
document.addEventListener('DOMContentLoaded', function () {
  $('#accountDataTable').DataTable({
    paging: true, // Enable pagination
    pageLength: 10, // Number of rows per page
    lengthChange: true, // Allow changing number of rows per page
    searching: false, // Disable search (optional, if not needed)
    ordering: true, // Enable column sorting
    order: [], // Disable initial ordering
    info: true, // Show info about current page and total rows
    language: {
      paginate: {
        previous: "{% trans 'Previous' %}",
        next: "{% trans 'Next' %}",
      },
      info: "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries' %}",
      lengthMenu: "{% trans 'Show _MENU_ entries' %}",
    },
  });
});


//for bank table
$(document).ready(function () {
        // Select/Deselect All Rows
        $('#selectAllBank').on('click', function () {
            $('.rowCheckboxBank').prop('checked', this.checked);
        });

        // If any row checkbox is unchecked, uncheck the selectAll checkbox
        $('.rowCheckboxBank').on('click', function () {
            if ($('.rowCheckboxBank:checked').length === $('.rowCheckboxBank').length) {
                $('#selectAllBank').prop('checked', true);
            } else {
                $('#selectAllBank').prop('checked', false);
            }
        });
    });


//for payee table
    $(document).ready(function () {
        // Select/Deselect All Rows
        $('#selectAllPayee').on('click', function () {
            $('.rowCheckboxPayee').prop('checked', this.checked);
        });

        // If any row checkbox is unchecked, uncheck the selectAll checkbox
        $('.rowCheckboxPayee').on('click', function () {
            if ($('.rowCheckboxPayee:checked').length === $('.rowCheckboxPayee').length) {
                $('#selectAllPayee').prop('checked', true);
            } else {
                $('#selectAllPayee').prop('checked', false);
            }
        });
    });


//for Account table
    $(document).ready(function () {
        // Select/Deselect All Rows
        $('#selectAllAccount').on('click', function () {
            $('.rowCheckboxAccount').prop('checked', this.checked);
        });

        // If any row checkbox is unchecked, uncheck the selectAll checkbox
        $('.rowCheckboxAccount').on('click', function () {
            if ($('.rowCheckboxAccount:checked').length === $('.rowCheckboxAccount').length) {
                $('#selectAllAccount').prop('checked', true);
            } else {
                $('#selectAllAccount').prop('checked', false);
            }
        });
    });

</script>
{% endblock scripts %}
